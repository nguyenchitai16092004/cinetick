@extends('frontend.layouts.master')
@section('title', 'Quên mật khẩu')
@section('main')
<style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    body {
      font-family: 'Oswald', Arial, sans-serif;
      min-height: 100vh;
      width: 100vw;
      margin: 0;
      background: radial-gradient(ellipse at bottom, #4a408c 0%, #10182b 80%);
      color: #fff;
      overflow-x: hidden;
    }
    .forgot-outer {
      min-height: 100vh;
      width: 100vw;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }
    .forgot-center-box {
      margin-top: 60px;
      width: 600px;
      max-width: 95vw;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .forgot-title {
      margin: 0;
      margin-bottom: 24px;
      text-align: center;
      font-family: 'Oswald', Arial, sans-serif;
      font-size: 3rem;
      font-weight: 700;
      letter-spacing: 2px;
      line-height: 1.1;
      text-transform: uppercase;
    }
    .forgot-desc {
      text-align: center;
      font-size: 1.3rem;
      font-family: 'Oswald', Arial, sans-serif;
      font-weight: 400;
      margin-bottom: 38px;
      color: #fff;
      line-height: 1.5;
    }
    .forgot-form {
      width: 100%;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    .forgot-form input[type="email"] {
      width: 100%;
      max-width: 600px;
      padding: 18px 20px;
      border-radius: 0;
      border: none;
      font-size: 1.22rem;
      font-family: inherit;
      background: #fff;
      color: #242424;
      outline: none;
      box-sizing: border-box;
      margin-bottom: 0;
      transition: box-shadow 0.15s;
      font-weight: 400;
      letter-spacing: 1.2px;
    }
    .forgot-form input[type="email"]:focus {
      box-shadow: 0 0 0 2px #f8e14299;
    }
    .forgot-form button, .forgot-form .btnRegister {
      width: 100%;
      max-width: 600px;
      padding: 18px 0;
      margin: 0;
      background: #f8e12f;
      color: #181818;
      font-size: 1.32rem;
      font-family: 'Oswald', Arial, sans-serif;
      font-weight: 700;
      border: none;
      border-radius: 0;
      cursor: pointer;
      letter-spacing: 2px;
      transition: filter 0.18s, background 0.18s;
      box-shadow: none;
      text-transform: uppercase;
      text-align: center;
    }
    .forgot-form button:active, .forgot-form .btnRegister:active {
      filter: brightness(0.97);
    }
    @media (max-width:700px) {
      .forgot-center-box { width: 98vw; }
      .forgot-form input, .forgot-form button { max-width: 99vw; }
      .forgot-title { font-size: 2.1rem; }
      .forgot-desc { font-size: 1.05rem;}
    }
</style>
<div class="forgot-outer">
    <div class="forgot-center-box">
      <h1 class="forgot-title">QUÊN MẬT KHẨU</h1>
      <div class="forgot-desc">
        Nhập địa chỉ email của bạn và chúng tôi sẽ gửi cho bạn<br>
        hướng dẫn để tạo mật khẩu mới
      </div>
      <form class="forgot-form" id="forgotForm" autocomplete="off" onsubmit="return false;">
        <input type="email" id="fgEmail" placeholder="Email" required>
        <button type="button" class="btnRegister" onclick="forgotPass()">GỬI MÃ XÁC MINH</button>
      </form>
      <div id="message" style="margin-top:22px;font-family:Oswald,sans-serif;font-size:1.1rem;font-weight:600;"></div>
    </div>
</div>
<script>
    function forgotPass() {
        var email = $("#fgEmail").val().trim();
        var msg = $("#message");
        msg.css("color", "#f8e12f").text('');
        if(email === "" || !/^[^@]+@[^@]+\.[^@]+$/.test(email)){
            msg.css("color", "#ff6060").text('Vui lòng nhập địa chỉ email hợp lệ!');
            return false;
        }
        msg.text('Đang gửi mã xác minh...');
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        var data = JSON.stringify({
            email: email,
            _token: $('meta[name="csrf-token"]').attr('content')
        });
        $.ajax({
            url: "{{ route('quen-mat-khau.post') }}",
            type: "POST",
            data: data,
            traditional: true,
            datatype: "json",
            contentType: 'application/json; charset=utf-8',
            success: function(result) {
                if (result === "true" || result === true) {
                    msg.css("color", "#6aff97");
                    msg.html('Vui lòng kiểm tra email để nhận mật khẩu mới.<br>Và đăng nhập <a href="{{ route('login.form') }}" style="color:#ffe440;">tại đây</a>');
                } else {
                    msg.css("color", "#ff6060").text(result);
                }
            },
            error: function(xhr) {
                msg.css("color", "#ff6060").text(xhr.responseText || 'Có lỗi xảy ra!');
            }
        });
    }
</script>
@endsection